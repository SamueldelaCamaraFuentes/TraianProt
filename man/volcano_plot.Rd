% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{volcano_plot}
\alias{volcano_plot}
\title{This function generates an interactive volcano plot using the 'plotly' package
based on differential expression results.}
\usage{
volcano_plot(limma, title, label, statval, psms)
}
\arguments{
\item{limma}{A data frame containing differential expression results.
This data frame must include columns:
\itemize{
\item \code{logFC}: Log-fold change values.
\item \code{Protein}: Protein identifiers (used for hover-text).
\item \code{expression}: A character vector (e.g., "Up-regulated",
"Down-regulated", "Unchanged") used for coloring.
\item \code{p.value} or \code{sca.P.Value}: Nominal p-values.
\item \code{adj.P.Val} or \code{sca.adj.pval}: Adjusted p-values.
}}

\item{title}{A character string for the plot title.}

\item{label}{A numeric value specifying the size of the markers (points)
in the plot. Passed to \code{size = I(label)}.}

\item{statval}{A numeric value (1 or 2) specifying which p-value to plot on
the y-axis.
\itemize{
\item \code{1}: Plots the nominal p-value (e.g., \code{p.value} or
\code{sca.P.Value}).
\item \code{2}: Plots the adjusted p-value (e.g., \code{adj.P.Val} or
\code{sca.adj.pval}).
}}

\item{psms}{A logical value (\code{TRUE} or \code{FALSE}).
\itemize{
\item \code{TRUE}: Uses PSM-aware p-values from DEqMS (i.e.,
\code{sca.P.Value} or \code{sca.adj.pval}).
\item \code{FALSE}: Uses standard p-values (i.e., \code{p.value} or
\code{adj.P.Val}).
}}
}
\value{
A \code{plotly} object, which renders as an interactive volcano plot.
}
\description{
This function generates an interactive volcano plot using the 'plotly' package
based on differential expression results.
}
\details{
The function selects the appropriate p-value column based on the \code{statval}
and \code{psms} arguments. The y-axis label is automatically set to "-log10 p-value"
or "-log10 q-value" (for adjusted p-values). Points are colored based on
the \code{expression} column.
}
\examples{
# Create a mock data frame for demonstration
limma_results <- data.frame(
  logFC = rnorm(100, 0, 2),
  Protein = paste0("PROT", 1:100),
  p.value = runif(100, 0, 1),
  adj.P.Val = runif(100, 0, 1),
  sca.P.Value = runif(100, 0, 1),
  sca.adj.pval = runif(100, 0, 1),
  expression = sample(c("Up-regulated", "Down-regulated", "Unchanged"),
                      100, replace = TRUE)
)

# Generate an interactive plot using adjusted p-values without PSM weighting
volcano_plot(limma = limma_results,
             title = "Interactive Volcano Plot",
             label = 5,
             statval = 2,
             psms = FALSE)

}
