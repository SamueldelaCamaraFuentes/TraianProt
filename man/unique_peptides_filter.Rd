% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{unique_peptides_filter}
\alias{unique_peptides_filter}
\title{Filter Proteins by Unique Peptide Counts}
\usage{
unique_peptides_filter(df, metadata, number, min_fraction)
}
\arguments{
\item{df}{A data frame with protein data. Must have rownames
(e.g., Protein IDs) and columns corresponding to unique
peptide counts.}

\item{metadata}{A metadata data frame. Must contain 'group' and
'unique_peptides_col' columns to map samples to groups.}

\item{number}{Numeric. The minimum number of unique peptides (e.g., 1 or 2)
required to count as 'present' in a single sample.}

\item{min_fraction}{Numeric. The minimum fraction (0 to 1) of replicates
in \emph{at least one} group that must meet the 'number'
threshold. (e.g., 0.5 means at least 50\% of replicates).}
}
\value{
A data frame (\code{df_filtered}) containing only the rows (proteins)
that pass the filter.
}
\description{
Filters a protein data frame based on a minimum number of
unique peptides found in a minimum fraction of replicates per condition.
}
\details{
This function is useful for filtering data (e.g., from MaxQuant) to
remove proteins with low confidence. It keeps a protein if, for
\strong{at least one} experimental group (condition), the unique peptide count is
\verb{>= number} in at least \code{min_fraction} of the samples in that group.
}
\examples{
# Create synthetic data
peptide_df <- data.frame(
  Pep.C1 = c(2, 0, 1, 5),
  Pep.C2 = c(3, 1, 0, 6),
  Pep.T1 = c(0, 2, 1, 0),
  Pep.T2 = c(0, 3, 0, 0)
)
rownames(peptide_df) <- c("ProtA", "ProtB", "ProtC", "ProtD")

meta <- data.frame(
  unique_peptides_col = c("Pep.C1", "Pep.C2", "Pep.T1", "Pep.T2"),
  group = c("Control", "Control", "Treatment", "Treatment")
)

# Filter: require min 1 peptide in at least 75\% of reps (i.e., 2/2)
# ProtA: Passes in Control (2/2 have >= 1). Kept.
# ProtB: Passes in Treatment (2/2 have >= 1). Kept.
# ProtC: Fails in Control (1/2), Fails in Treatment (1/2). Dropped.
# ProtD: Passes in Control (2/2 have >= 1). Kept.

filtered_df <- unique_peptides_filter(
  df = peptide_df,
  metadata = meta,
  number = 1,
  min_fraction = 0.75
)

print("Filtered proteins (should be A, B, D):")
print(rownames(filtered_df))

}
