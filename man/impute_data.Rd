% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{impute_data}
\alias{impute_data}
\title{Impute Missing Values using Down-Shifted Normal Distribution}
\usage{
impute_data(df, LOG2.names, width = 0.3, downshift = 1.8)
}
\arguments{
\item{df}{A data frame. This frame \strong{must} contain a logical column named
\code{KEEP} which specifies the rows to be used for calculating the
mean and standard deviation of the valid data.}

\item{LOG2.names}{A character vector of column names (from \code{df}) to impute.}

\item{width}{Numeric. The factor by which to shrink the standard deviation
of the valid data (e.g., 0.3).}

\item{downshift}{Numeric. The factor (in standard deviations) by which to
shift the mean of the valid data (e.g., 1.8).}
}
\value{
The data frame \code{df} with imputed LOG2 columns and new 'impute.*'
logical columns indicating which values were imputed.
}
\description{
Replaces non-finite (NA, Inf) values in specified LOG2 columns
with random values drawn from a normal distribution. This distribution is
shifted to a lower mean and narrower standard deviation relative to the
observed valid data.
}
\details{
This method is a common "down-shift" or "Perseus-style" imputation
for label-free proteomics, simulating the low-abundance signals of
proteins near the detection limit. It assumes missingness is not at random
(MNAR).
}
\examples{
# Create synthetic LOG2 data with non-finite values (Inf)
log_df <- data.frame(
  Protein = c("ProtA", "ProtB", "ProtC", "ProtD"),
  LOG2.S1 = c(10, 12, Inf, 8),
  LOG2.S2 = c(11, 13, Inf, Inf),
  # Add a KEEP column (e.g., from a filter)
  # Here, we keep all proteins for calculation
  KEEP = c(TRUE, TRUE, TRUE, TRUE)
)

# Specify columns to impute
log_cols <- c("LOG2.S1", "LOG2.S2")

# Run imputation
set.seed(123) # for reproducible example
imputed_df <- impute_data(log_df, log_cols)

print("Original Data:")
print(log_df)
print("Imputed Data:")
print(imputed_df)

}
