% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{Goterms_finder}
\alias{Goterms_finder}
\title{Find GO Terms (gprofiler2)}
\usage{
Goterms_finder(
  df,
  raw,
  target,
  numeric_ns,
  mthreshold,
  filter_na,
  organismo,
  custombg,
  platform,
  ...
)
}
\arguments{
\item{df}{A data frame from statistical analysis (e.g., limma), must have
'expression', 'p.value', 'Protein', and/or 'Protein_description'
columns.}

\item{raw}{A data frame of the "raw" data, used to build the background gene
list. Must have 'Protein' or 'Protein_description'.}

\item{target}{Character. The target namespace for gconvert (e.g., "ENSG").}

\item{numeric_ns}{Character. Namespace for numeric IDs.}

\item{mthreshold}{Numeric. g:GOSt multi-query significance threshold.}

\item{filter_na}{Logical. Whether gconvert should filter out NA results.}

\item{organismo}{Character. The organism name for gprofiler2 (e.g., "hsapiens").}

\item{custombg}{Logical. Whether to use a custom background (from \code{raw}).}

\item{platform}{Numeric. An indicator for the data platform (1, 2, 3, or 4).}

\item{...}{Additional arguments passed to \code{gprofiler2::gost}.}
}
\value{
A list named \code{go_structures} containing:
1. A \code{compareClusterResult} object (for plotting).
2. An \code{enrichResult} object (for plotting).
3. The raw \code{gost} result object (for \code{gostplot}).
}
\description{
Performs Gene Ontology (GO) and pathway enrichment analysis
for up- and down-regulated proteins using gprofiler2.
}
\examples{

\donttest{
limma_df <- data.frame(
   Protein = c("P04637", "P00533", "P01116"),
   Protein_description = c("TP53", "EGFR", "KRAS"),
   expression = c("Up-regulated", "Up-regulated", "Up-regulated"),
   p.value = c(0.001, 0.002, 0.003)
)

# raw_df is needed for the function structure, even if custombg=FALSE
raw_df <- data.frame(
   Protein = c("P04637", "P00533", "P01116", "P62258"),
   Protein_description = c("TP53", "EGFR", "KRAS", "ACTB")
)

# 2. Run the function with checks
# This example requires an internet connection

if (requireNamespace("gprofiler2", quietly = TRUE)) {

   try({
     go_res <- Goterms_finder(
       df = limma_df,
       raw = raw_df,
       target = "ENSG",
       numeric_ns = "",
       mthreshold = 0.05,
       filter_na = TRUE,
       organismo = "hsapiens",
       custombg = FALSE,
       platform = 1
     )

     # 3. Safe printing (checks if result exists before printing)
     # We check if go_res exists, is a list, and has the expected slot
     if (!is.null(go_res) &&
         is.list(go_res) &&
         length(go_res) >= 1 &&
         inherits(go_res[[1]], "compareClusterResult")) {

       print(head(go_res[[1]]@compareClusterResult))
     }
   }, silent = TRUE)
}
}
}
